## Approach Reviewer によるレビュー結果

### 1. 判定 (Decision)

- **Status**: Request Changes

**判定基準:** P0 が1件以上存在する場合は Request Changes とする。P0 が0件の場合は Approve とする。

### 2. 良い点 (Strengths)

- **代替案の検討（案A vs 案B）**: YAGNI の原則に基づき、NodesSearched のみが必要な現時点でインスタンスフィールド方式を選択した判断は、既存コードベース（`_bestMove`, `_currentDepth`）との一貫性も含めて妥当である。
- **TT Probe ヒット時のカウント方針**: `Pvs()` 先頭でカウント済みのため追加不要という整理は論理的に正確であり、TT ON/OFF の差分評価を正しく可能にする設計である。
- **後方互換性の維持**: `SearchResult` コンストラクタにデフォルト値を設定し、`ISearchEngine` インターフェースを変更しない方針は、既存コードへの影響を最小化する適切な判断である。
- **ロードマップとの整合性**: WZebra RFC ロードマップにおいて RFC 2〜4 の前提として位置付けられた計測基盤を最初に整備する順序は合理的である。
- **Non-Goals の明確化**: NPS 計測を RFC 4 に委譲し、LegacySearchEngine を対象外とするスコープの線引きに論理的根拠がある。

### 3. 指摘事項 (Issues)

#### Severity 定義

| Severity | 定義 |
| :--- | :--- |
| **P0 (Blocker)** | 修正必須。論理的欠陥、仕様漏れ、重大なリスク、回答必須の質問 |
| **P1 (Nit)** | 提案。より良い手法、軽微な懸念、参考情報 |

#### 指摘一覧

**[P0-1] Logger クラスの導入がスコープ過大である**
- **対象セクション**: 5.3 Logger クラスの導入 / 3. 目的とスコープ
- **内容**: 本 RFC の本質的な課題は「探索ノード数の計測基盤がないこと」である。しかし Logger クラスの導入（構造化ログ、日付ベースローテーション、自動クリーンアップ）は独立した横断的関心事であり、NodesSearched 計測とは別の課題を解決している。1つの RFC に 2 つの独立した課題を混在させることで、レビュー・実装・ロールバックの単位が不明確になる。
- **修正の期待値**: Logger クラスの導入を別 RFC として切り出すか、本 RFC では `Console.WriteLine` や既存の `FileHelper.Log()` による最小限のログ出力に留め、Logger の導入は後続の RFC で行うべきである。

**[P0-2] Aspiration Window 再探索時のノードカウントに論理的曖昧さがある**
- **対象セクション**: 5.2 PvsSearchEngine へのカウンタ導入（Search() メソッド）
- **内容**: RFC では `_nodesSearched` を「深さごとにリセット」し `totalNodesSearched` に加算すると記述しているが、`AspirationRootSearch` 内で成功時に `RootSearch` を2回呼ぶ設計（retry 探索 + 最終確定の再探索）となっている。深さごとのリセットが `AspirationRootSearch` 呼び出し前の1回のみだと、最終確定の再探索ノード数のみが `_nodesSearched` に残り、retry 分は `totalNodesSearched` に加算されない。仮定として「retry のノードも含める」と記載されているが、実装の擬似コードと矛盾する。
- **修正の期待値**: `AspirationRootSearch` 内の複数回の `RootSearch` 呼び出しに対して、`_nodesSearched` のリセットと累積がどう動作するかを正確に記述し、擬似コードとの整合性を確保すべきである。

**[P1-1] ログ機構の代替案検討において「既存の仕組みで十分か」の観点が不足している**
- **対象セクション**: 6. 代替案の検討（ログ機構の代替案）
- **内容**: 代替案として Microsoft.Extensions.Logging と独自 Logger を比較しているが、「ログ機構を導入しない」（＝既存の `Console.WriteLine` や `FileHelper.Log()` で NodesSearched を出力する）という最も単純な選択肢が検討されていない。本 RFC の目的が「計測基盤の導入」であれば、`SearchResult.NodesSearched` が返却されるだけで十分であり、ログ出力は呼び出し元の責務とすることも可能である。
- **修正の期待値**: 「ログ機構を導入しない」案を代替案として追加し、採用/不採用の根拠を明記すべきである。

**[P1-2] RootSearch のベータカット未実装に起因するカウント漏れの可能性**
- **対象セクション**: 5.2 PvsSearchEngine へのカウンタ導入（カウント方針）
- **内容**: 現在の `RootSearch` 実装にはベータカットがなく、全合法手を展開している。RFC のカウント方針表では `RootSearch` の各子ノード展開をカウント対象としているが、`Pvs()` メソッド先頭でカウントするため `RootSearch` 側での追加カウントは不要のはずである。カウント方針表に「RootSearch の各子ノード展開」を記載しているのは冗長であり、二重カウントと誤解される可能性がある。
- **修正の期待値**: カウント方針表を整理し、実際のインクリメント箇所は `Pvs()` メソッド先頭の1箇所のみであることを明確にすべきである。

**[P1-3] 静的クラスによる Logger 設計がテスト容易性を阻害する可能性がある**
- **対象セクション**: 5.3.2 Logger クラスの設計
- **内容**: `Logger` を静的クラスとして設計しているが、テスト時にログ出力先やログレベルを差し替える際にグローバルステートの変更が必要となり、テストの並列実行や独立性に影響する。現状の `FileHelper` と同じパターンではあるが、新規導入するクラスで同じ課題を再生産することになる。
- **修正の期待値**: 本 RFC のスコープで対処する必要はないが、将来的な DI 対応の可能性をトレードオフとして記載することを推奨する。
